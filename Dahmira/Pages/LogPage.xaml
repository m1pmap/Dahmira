<Window x:Class="Dahmira.Pages.LogPage"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Dahmira.Pages"
        mc:Ignorable="d"
        Title="LogPage" Height="850" Width="1700" WindowStartupLocation="CenterScreen" WindowStyle="None" AllowsTransparency="True" Background="Transparent"
        KeyDown="Window_KeyDown" MouseDown="Window_MouseDown" Topmost="True">

    <Window.Resources>
        <!--Стиль для кнопки с закруглёнными краями-->
        <ControlTemplate TargetType="Button" x:Key="btTemplate">
            <Border x:Name="border"
                 CornerRadius="7" 
                 Background="{TemplateBinding Background}">
                <Grid 
                     HorizontalAlignment="Center" 
                     VerticalAlignment="Center">
                    <ContentPresenter HorizontalAlignment="Center" 
                           VerticalAlignment="Center" 
                           Content="{TemplateBinding Content}" 
                           ContentTemplate="{TemplateBinding ContentTemplate}"/>
                </Grid>
            </Border>
            <ControlTemplate.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter TargetName="border" Property="Background" Value="LightBlue"/>
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>

        <Style TargetType="TextBox">
            <Setter Property="Background" Value="White"/>
            <Setter Property="FontFamily" Value="Arial Black"/>
            <Setter Property="Foreground" Value="Gray"/>
            <Setter Property="BorderBrush" Value="Gray"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="border"
                 Background="White"
                 BorderBrush="{TemplateBinding BorderBrush}"
                 BorderThickness="1.7"
                 CornerRadius="4">
                            <ScrollViewer x:Name="PART_ContentHost"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <!-- Изменение цвета при фокусе -->
                            <Trigger Property="IsFocused" Value="True">
                                <Setter TargetName="border" Property="BorderBrush" Value="CornFlowerBlue"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--Стиль для dataGrid-->
        <Style TargetType="DataGrid">
            <!-- Make the border and grid lines a little less imposing -->
            <Setter Property="BorderBrush" Value="#DDDDDD" />
            <Setter Property="HorizontalGridLinesBrush" Value="#DDDDDD" />
            <Setter Property="VerticalGridLinesBrush" Value="#DDDDDD" />

            <Setter Property="CellStyle">
                <Setter.Value>
                    <Style TargetType="DataGridCell">
                        <Style.Triggers>
                            <!--Highlight selected rows-->
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="CornflowerBlue"/>
                                <Setter Property="BorderBrush" Value="CornflowerBlue"/>
                                <Setter Property="Foreground" Value="White" />
                            </Trigger>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter Property="Background" Value="LightSkyBlue"/>
                                <Setter Property="BorderBrush" Value="LightSkyBlue"/>
                                <Setter Property="Foreground" Value="White" />
                            </Trigger>
                        </Style.Triggers>
                        <!-- Add some padding around the contents of a cell -->
                        <Setter Property="Padding" Value="4,3,4,3" />
                        <Setter Property="BorderBrush" Value="Transparent"/>
                        <Setter Property="BorderThickness" Value="1"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="DataGridCell">
                                    <Border Padding="{TemplateBinding Padding}" 
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    Background="{TemplateBinding Background}">
                                        <ContentPresenter />
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                        <Setter Property="FocusVisualStyle">
                            <Setter.Value>
                                <Style TargetType="Control">
                                    <Setter Property="BorderBrush" Value="Transparent" />
                                </Style>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition/>
            <ColumnDefinition Width="40"/>
        </Grid.ColumnDefinitions>
        <Border Background="White" CornerRadius="15" BorderThickness="1.7" BorderBrush="Gray">
            <StackPanel Orientation="Vertical" Margin="10">
                <StackPanel Orientation="Horizontal">
                    <Button x:Name="clearLogs_button"
                            Height="30" Width="98"
                            Background="Gray"
                            Content="ОЧИСТИТЬ"
                            Foreground="White"
                            FontFamily="Arial Black"
                            Template="{StaticResource btTemplate}"
                            Click="clearLogs_button_Click"/>

                    <CheckBox VerticalAlignment="Center" Margin="10,0,0,0"
                              IsChecked="True"
                              Checked="CheckBox_Checked"
                              Unchecked="CheckBox_Unchecked"
                              Content="Отображение поверх окон" VerticalContentAlignment="Center" 
                              Foreground="Gray" FontFamily="Arial"/>
                </StackPanel>

                <DataGrid Height="478" Margin="0,5,0,0"
                          x:Name="log_dataGrid" Grid.Row="1" AutoGenerateColumns="False" Background="Transparent"
                          MinRowHeight="20" CanUserSortColumns="False"
                          CanUserAddRows="False" FontFamily="Arial" 
                          Foreground="Black" IsReadOnly="True"
                          RowHeaderWidth="0" SelectedIndex="0" RowHeight="24" HorizontalScrollBarVisibility="Hidden"
                          SelectedCellsChanged="log_dataGrid_SelectedCellsChanged">

                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Дата и время" Width="0.75*" Binding="{Binding DateTime, StringFormat='dd.MM.yyyy HH:mm:ss'}"/>

                        <DataGridTemplateColumn Header="Уровень" Width="0.32*">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Image Source="{Binding Lvl, Converter={StaticResource LogLvlToImageSourceConverter}}"
                                               Width="17" Height="17" Visibility="{Binding Lvl, Converter={StaticResource LvlLogToVisibilityConverter}}"
                                               ToolTip="{Binding Lvl}"/>
                                        <TextBlock Text="{Binding Lvl}"
                                                   Visibility="{Binding Lvl, Converter={StaticResource InverseLvlLogToVisibilityConverter}}"/>
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <DataGridTextColumn Header="Место" Binding="{Binding EntryPoint}" Width="*"/>

                        <DataGridTextColumn Header="Ex_HResult" Binding="{Binding Ex_HResult}" Width="0.5*"/>

                        <DataGridTextColumn Header="Ex_GetType" Binding="{Binding Ex_GetType}" Width="1.3*"/>

                        <DataGridTextColumn Header="Ex_Mesage" Binding="{Binding Ex_Mesage}" Width="2*"/>

                        <DataGridTextColumn Header="Ex_InnerExceptionMesage" Binding="{Binding Ex_InnerExceptionMesage}" Width="*"/>

                        <DataGridTextColumn Header="Ex_StackTrace" Binding="{Binding Ex_StackTrace}" Width="2*"/>

                        <DataGridTextColumn Header="Пользователь" Binding="{Binding CurrentUser}" Width="0.5*"/>

                    </DataGrid.Columns>

                    <DataGrid.RowStyle>
                        <Style TargetType="DataGridRow">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Lvl, Converter={StaticResource StringToLowerCaseConverter}}" Value="error">
                                    <Setter Property="Background" Value="#FFE4E1"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Lvl, Converter={StaticResource StringToLowerCaseConverter}}" Value="information">
                                    <Setter Property="Background" Value="#F0FFFF"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Lvl, Converter={StaticResource StringToLowerCaseConverter}}" Value="warning">
                                    <Setter Property="Background" Value="#FFFFF0"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Lvl, Converter={StaticResource StringToLowerCaseConverter}}" Value="debug">
                                    <Setter Property="Background" Value="#FFFFFF"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.RowStyle>

                    <DataGrid.CellStyle>
                        <Style TargetType="DataGridCell">
                            <EventSetter Event="GotFocus" Handler="DataGridCell_GotFocus"/>
                            <Setter Property="BorderThickness" Value="0"/>
                            <Setter Property="Padding" Value="4"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="DataGridCell">
                                        <Border Padding="{TemplateBinding Padding}" 
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}"
                        Background="{TemplateBinding Background}">
                                            <ContentPresenter />
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>

                            <Style.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="CornflowerBlue"/>
                                    <Setter Property="Foreground" Value="White"/>
                                </Trigger>

                                <Trigger Property="IsFocused" Value="True">
                                    <Setter Property="Background" Value="LightSkyBlue"/>
                                    <Setter Property="Foreground" Value="White"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.CellStyle>
                </DataGrid>

                <Label Content="Место" FontFamily="Arial" Foreground="Gray" Margin="0,10,0,-5"/>
                <StackPanel Orientation="Horizontal">
                    <TextBox x:Name="entryPoint_textBox" FontFamily="Consolas" Foreground="Gray" FontSize="15" Padding="2,0" IsReadOnly="True" Width="1636"/>
                    <Image x:Name="logImage_image" Source="/resources/images/errorLog.png"
                           Width="20" Height="20" Margin="5,0,0,0"/>
                </StackPanel>

                <StackPanel Orientation="Horizontal">
                    <StackPanel Orientation="Vertical">
                        <Label Content="Ex_Message" FontFamily="Arial" Foreground="Gray" Margin="0,0,0,-5"/>
                        <TextBox x:Name="exMessage_textBox" AcceptsReturn="True" AcceptsTab="True" 
                                 Padding="2" FontFamily="Consolas" Foreground="Gray" FontSize="15"
                                 Width="813" Height="242" TextWrapping="Wrap" IsReadOnly="True"/>
                    </StackPanel>

                    <StackPanel Orientation="Vertical" Margin="10,0,0,0">
                        <Label x:Name="clickedColumn_label" Content="ClickedColumn" FontFamily="Arial" Foreground="Gray" Margin="0,0,0,-5"/>
                        <TextBox x:Name="clickedColumn_textBox" AcceptsReturn="True" AcceptsTab="True" 
                                 Padding="2" FontFamily="Consolas" Foreground="Gray" FontSize="15"
                                 Width="813" Height="242" TextWrapping="Wrap" IsReadOnly="True"/>
                    </StackPanel>
                </StackPanel>

            </StackPanel>
        </Border>

        <Button x:Name="exit_button" Grid.Column="1"
            Template="{StaticResource btTemplate}" 
            Height="30" Width="30"
            Background="OrangeRed" 
            VerticalAlignment="Top"
            HorizontalAlignment="Center"
            Margin="0,10,0,0" 
            ToolTip="Закрыть окно"
            Click="exit_button_Click">

            <Image Source="/resources/images/delete_image.png" Height="22" Width="22"/>
        </Button>
    </Grid>
</Window>
